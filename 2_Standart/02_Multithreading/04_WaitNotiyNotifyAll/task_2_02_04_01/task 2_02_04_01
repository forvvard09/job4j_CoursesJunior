Реализуйте шаблон Producer Consumer.

Для этого вам необходимо реализовать собственную версию bounded blocking queue. Это блокирующая очередь, ограниченная по размеру. В данном шаблоне Producer помещает данные в очередь, а Consumer извлекает данные из очереди.